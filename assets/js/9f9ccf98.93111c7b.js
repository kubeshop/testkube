"use strict";(self.webpackChunktestkube_documentation=self.webpackChunktestkube_documentation||[]).push([[3525],{3905:(e,t,n)=>{n.d(t,{Zo:()=>l,kt:()=>d});var s=n(67294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t){if(null==e)return{};var n,s,o=function(e,t){if(null==e)return{};var n,s,o={},a=Object.keys(e);for(s=0;s<a.length;s++)n=a[s],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(s=0;s<a.length;s++)n=a[s],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var i=s.createContext({}),c=function(e){var t=s.useContext(i),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},l=function(e){var t=c(e.components);return s.createElement(i.Provider,{value:t},e.children)},k={inlineCode:"code",wrapper:function(e){var t=e.children;return s.createElement(s.Fragment,{},t)}},p=s.forwardRef((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,i=e.parentName,l=u(e,["components","mdxType","originalType","parentName"]),p=c(n),d=o,b=p["".concat(i,".").concat(d)]||p[d]||k[d]||a;return n?s.createElement(b,r(r({ref:t},l),{},{components:n})):s.createElement(b,r({ref:t},l))}));function d(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,r=new Array(a);r[0]=p;var u={};for(var i in t)hasOwnProperty.call(t,i)&&(u[i]=t[i]);u.originalType=e,u.mdxType="string"==typeof e?e:o,r[1]=u;for(var c=2;c<a;c++)r[c]=n[c];return s.createElement.apply(null,r)}return s.createElement.apply(null,n)}p.displayName="MDXCreateElement"},16103:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>i,contentTitle:()=>r,default:()=>k,frontMatter:()=>a,metadata:()=>u,toc:()=>c});var s=n(87462),o=(n(67294),n(3905));const a={},r="Testkube GitHub Action",u={unversionedId:"articles/github-actions",id:"articles/github-actions",title:"Testkube GitHub Action",description:"The Testkube GitHub Action installs Testkube and enables running any Testkube CLI command in a GitHub workflow. It is available on Github Marketplace .",source:"@site/docs/articles/github-actions.md",sourceDirName:"articles",slug:"/articles/github-actions",permalink:"/articles/github-actions",draft:!1,editUrl:"https://github.com/kubeshop/testkube/tree/develop/docs/docs/articles/github-actions.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Using Testkube from CI/CD",permalink:"/articles/cicd-overview"},next:{title:"Testkube Gitlab CI",permalink:"/articles/gitlab"}},i={},c=[{value:"Testkube Pro",id:"testkube-pro",level:2},{value:"How to configure Testkube CLI action for Testkube Pro and Run a Test",id:"how-to-configure-testkube-cli-action-for-testkube-pro-and-run-a-test",level:3},{value:"Testkube OSS",id:"testkube-oss",level:2},{value:"How to Configure Testkube CLI Actions for Testkube OSS and Run a Test",id:"how-to-configure-testkube-cli-actions-for-testkube-oss-and-run-a-test",level:3},{value:"How to Configure Testkube CLI Actions for Testkube OSS and Run a Test",id:"how-to-configure-testkube-cli-actions-for-testkube-oss-and-run-a-test-1",level:3},{value:"How to Connect to GKE (Google Kubernetes Engine) Cluster and Run a Test",id:"how-to-connect-to-gke-google-kubernetes-engine-cluster-and-run-a-test",level:3},{value:"Complete Example of Working GitHub Actions Workflow and Testkube Tests Usage",id:"complete-example-of-working-github-actions-workflow-and-testkube-tests-usage",level:3}],l={toc:c};function k(e){let{components:t,...n}=e;return(0,o.kt)("wrapper",(0,s.Z)({},l,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"testkube-github-action"},"Testkube GitHub Action"),(0,o.kt)("p",null,"The Testkube GitHub Action installs Testkube and enables running any ",(0,o.kt)("a",{parentName:"p",href:"https://docs.testkube.io/cli/testkube"},"Testkube CLI")," command in a GitHub workflow. It is available on Github Marketplace ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/marketplace/actions/testkube-action"},"https://github.com/marketplace/actions/testkube-action"),".\nThe action provides a flexible way to work with your pipeline and can be used with Testkube Pro, Testkube Enterprise, and an open source Testkube platform."),(0,o.kt)("h2",{id:"testkube-pro"},"Testkube Pro"),(0,o.kt)("h3",{id:"how-to-configure-testkube-cli-action-for-testkube-pro-and-run-a-test"},"How to configure Testkube CLI action for Testkube Pro and Run a Test"),(0,o.kt)("p",null,"To use this GitHub Action for the ",(0,o.kt)("a",{parentName:"p",href:"https://app.testkube.io/"},"Testkube Pro"),", you need to create an ",(0,o.kt)("a",{parentName:"p",href:"https://docs.testkube.io/testkube-pro/articles/organization-management/#api-tokens"},"API token"),".\nThen, pass the ",(0,o.kt)("strong",{parentName:"p"},"organization")," and ",(0,o.kt)("strong",{parentName:"p"},"environment")," IDs, along with the ",(0,o.kt)("strong",{parentName:"p"},"token")," and other parameters specific for your use case."),(0,o.kt)("p",null,"If a test is already created, you may directly run it using the command ",(0,o.kt)("inlineCode",{parentName:"p"},"testkube run test test-name -f")," . However, if you need to create a test in this workflow, please add a creation command, e.g.: ",(0,o.kt)("inlineCode",{parentName:"p"},"testkube create test --name test-name --file path_to_file.json"),"."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-yaml"},"steps:\n  - uses: kubeshop/setup-testkube@v1\n    with:\n      organization: tkcorg_0123456789abcdef\n      environment: tkcenv_fedcba9876543210\n      token: tkcapi_0123456789abcdef0123456789abcd\n\n  - run: |\n      testkube run test test-name -f \n\n")),(0,o.kt)("p",null,"It is recommended that sensitive values should never be stored as plaintext in workflow files, but rather as ",(0,o.kt)("a",{parentName:"p",href:"https://docs.github.com/en/actions/security-guides/using-secrets-in-github-actions"},"secrets"),".  Secrets can be configured at the organization, repository, or environment level, and allow you to store sensitive information in GitHub."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-yaml"},"steps:\n  - uses: kubeshop/setup-testkube@v1\n    with:\n      organization: ${{ secrets.TkOrganization }}\n      environment: ${{ secrets.TkEnvironment }}\n      token: ${{ secrets.TkToken }}\n\n  - run: |\n      testkube run test test-name -f \n\n")),(0,o.kt)("h2",{id:"testkube-oss"},"Testkube OSS"),(0,o.kt)("h3",{id:"how-to-configure-testkube-cli-actions-for-testkube-oss-and-run-a-test"},"How to Configure Testkube CLI Actions for Testkube OSS and Run a Test"),(0,o.kt)("p",null,"To connect to the self-hosted instance, you need to have ",(0,o.kt)("strong",{parentName:"p"},"kubectl")," configured for accessing your Kubernetes cluster, and simply passing optional namespace, if Testkube is not deployed in the default ",(0,o.kt)("strong",{parentName:"p"},"testkube")," namespace. "),(0,o.kt)("p",null,"If a test is already created, you may run it using the command ",(0,o.kt)("inlineCode",{parentName:"p"},"testkube run test test-name -f")," . However, if you need to create a test in this workflow, please add a creation command, e.g.: ",(0,o.kt)("inlineCode",{parentName:"p"},"testkube create test --name test-name --file path_to_file.json"),"."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-yaml"},"steps: \n  - uses: kubeshop/setup-testkube@v1\n    with:\n      namespace: custom-testkube\n\n  - run: |\n      testkube run test test-name -f \n\n")),(0,o.kt)("p",null,"Steps to connect to your Kubernetes cluster differ for each provider. You should check the docs of your Cloud provider on how to connect to the Kubernetes cluster from GitHub Action, or check examples in this documentation for selected providers."),(0,o.kt)("h3",{id:"how-to-configure-testkube-cli-actions-for-testkube-oss-and-run-a-test-1"},"How to Configure Testkube CLI Actions for Testkube OSS and Run a Test"),(0,o.kt)("p",null,"This workflow establishes a connection to EKS cluster and creates and runs a test using Testkube CLI. In this example, we also use GitHub secrets not to reveal sensitive data. Please make sure that the following points are satisfied:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"The ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("em",{parentName:"strong"},"AwsAccessKeyId")),", ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("em",{parentName:"strong"},"AwsSecretAccessKeyId"))," secrets should contain your AWS IAM keys with proper permissions to connect to EKS cluster."),(0,o.kt)("li",{parentName:"ul"},"The ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("em",{parentName:"strong"},"AwsRegion"))," secret should contain an AWS region where EKS is."),(0,o.kt)("li",{parentName:"ul"},"Tke ",(0,o.kt)("strong",{parentName:"li"},"EksClusterName")," secret points to the name of EKS cluster you want to connect.")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-yaml"},"steps:   \n  - name: Checkout\n    uses: actions/checkout@v4\n\n  - uses: aws-actions/configure-aws-credentials@v4\n    with:\n      aws-access-key-id: ${{ secrets.aws-access-key }}\n      aws-secret-access-key: ${{ secrets.aws-secret-access-key }} \n      aws-region:  ${{ secrets.aws-region }}  \n\n  - run: |\n      aws eks update-kubeconfig --name ${{ secrets.eks-cluster-name }} --region ${{ secrets.aws-region }} \n\n  - uses: kubeshop/setup-testkube@v1\n    - \n  - run: |\n      testkube run test test-name -f \n")),(0,o.kt)("h3",{id:"how-to-connect-to-gke-google-kubernetes-engine-cluster-and-run-a-test"},"How to Connect to GKE (Google Kubernetes Engine) Cluster and Run a Test"),(0,o.kt)("p",null,"This example connects to a k8s cluster in Google Cloud, creates and runs a test using Testkube GH Action. Please make sure that the following points are satisfied:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"The ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("em",{parentName:"strong"},"GKE Sevice Account"))," should be created prior in Google Cloud and added to GH Secrets along with ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("em",{parentName:"strong"},"GKE Project"))," value;"),(0,o.kt)("li",{parentName:"ul"},"The ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("em",{parentName:"strong"},"GKE Cluster Name"))," and ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("em",{parentName:"strong"},"GKE Zone"))," can be added as ",(0,o.kt)("a",{parentName:"li",href:"https://docs.github.com/en/actions/learn-github-actions/variables"},"environmental variables")," in the workflow.")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-yaml"},"steps:    \n  - name: Checkout\n    uses: actions/checkout@v4\n\n  - uses: google-github-actions/setup-gcloud@1bee7de035d65ec5da40a31f8589e240eba8fde5\n    with:\n      service_account_key: ${{ secrets.GKE_SA_KEY }}\n      project_id: ${{ secrets.GKE_PROJECT }}\n\n  - run: |-\n      gcloud --quiet auth configure-docker\n\n  - uses: google-github-actions/get-gke-credentials@db150f2cc60d1716e61922b832eae71d2a45938f\n    with:\n      cluster_name: ${{ env.GKE_CLUSTER_NAME }}\n      location: ${{ env.GKE_ZONE }}\n      credentials: ${{ secrets.GKE_SA_KEY }}\n\n  - uses: kubeshop/setup-testkube@v1\n  - run: |\n      testkube run test test-name -f \n")),(0,o.kt)("p",null,"Please consult the official documentation from GitHub on how to connect to GKE for more information ",(0,o.kt)("a",{parentName:"p",href:"https://docs.github.com/en/actions/deployment/deploying-to-google-kubernetes-engine"},"here"),"."),(0,o.kt)("h3",{id:"complete-example-of-working-github-actions-workflow-and-testkube-tests-usage"},"Complete Example of Working GitHub Actions Workflow and Testkube Tests Usage"),(0,o.kt)("p",null,"To integrate Testkube Github Actions into your workflow, please take a look at the example that sets up connection to GKE and creates and runs a test:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-yaml"},"name: Running Testkube Tests.\non:\n  push:\n    branches:\n      - main\nenv:\n  PROJECT_ID: ${{ secrets.GKE_PROJECT }}\n  GKE_CLUSTER: cluster-1    # Add your cluster name here.\n  GKE_ZONE: us-central1-c   # Add your cluster zone here.\n\njobs:\n  setup-build-publish-deploy:\n    name: Connect to GKE\n    runs-on: ubuntu-latest\n\n    steps:\n    - name: Checkout\n      uses: actions/checkout@v4\n\n    - uses: google-github-actions/setup-gcloud@1bee7de035d65ec5da40a31f8589e240eba8fde5\n      with:\n        service_account_key: ${{ secrets.GKE_SA_KEY }}\n        project_id: ${{ secrets.GKE_PROJECT }}\n\n    - run: |-\n        gcloud --quiet auth configure-docker\n\n    - uses: google-github-actions/get-gke-credentials@db150f2cc60d1716e61922b832eae71d2a45938f\n      with:\n        cluster_name: ${{ env.GKE_CLUSTER }}\n        location: ${{ env.GKE_ZONE }}\n        credentials: ${{ secrets.GKE_SA_KEY }}\n\n\n      - uses: kubeshop/setup-testkube@v1\n      - run: |\n          testkube run test test-name -f \n")))}k.isMDXComponent=!0}}]);