"use strict";(self.webpackChunktestkube_documentation=self.webpackChunktestkube_documentation||[]).push([[7187],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>m});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=a.createContext({}),u=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=u(e.components);return a.createElement(l.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),d=u(n),m=r,h=d["".concat(l,".").concat(m)]||d[m]||p[m]||o;return n?a.createElement(h,i(i({ref:t},c),{},{components:n})):a.createElement(h,i({ref:t},c))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=d;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:r,i[1]=s;for(var u=2;u<o;u++)i[u]=n[u];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},85162:(e,t,n)=>{n.d(t,{Z:()=>i});var a=n(67294),r=n(86010);const o="tabItem_Ymn6";function i(e){let{children:t,hidden:n,className:i}=e;return a.createElement("div",{role:"tabpanel",className:(0,r.Z)(o,i),hidden:n},t)}},74866:(e,t,n)=>{n.d(t,{Z:()=>v});var a=n(87462),r=n(67294),o=n(86010),i=n(12466),s=n(76775),l=n(91980),u=n(67392),c=n(50012);function p(e){return function(e){var t;return(null==(t=r.Children.map(e,(e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})))?void 0:t.filter(Boolean))??[]}(e).map((e=>{let{props:{value:t,label:n,attributes:a,default:r}}=e;return{value:t,label:n,attributes:a,default:r}}))}function d(e){const{values:t,children:n}=e;return(0,r.useMemo)((()=>{const e=t??p(n);return function(e){const t=(0,u.l)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,n])}function m(e){let{value:t,tabValues:n}=e;return n.some((e=>e.value===t))}function h(e){let{queryString:t=!1,groupId:n}=e;const a=(0,s.k6)(),o=function(e){let{queryString:t=!1,groupId:n}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:t,groupId:n});return[(0,l._X)(o),(0,r.useCallback)((e=>{if(!o)return;const t=new URLSearchParams(a.location.search);t.set(o,e),a.replace({...a.location,search:t.toString()})}),[o,a])]}function g(e){const{defaultValue:t,queryString:n=!1,groupId:a}=e,o=d(e),[i,s]=(0,r.useState)((()=>function(e){let{defaultValue:t,tabValues:n}=e;if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!m({value:t,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const a=n.find((e=>e.default))??n[0];if(!a)throw new Error("Unexpected error: 0 tabValues");return a.value}({defaultValue:t,tabValues:o}))),[l,u]=h({queryString:n,groupId:a}),[p,g]=function(e){let{groupId:t}=e;const n=function(e){return e?`docusaurus.tab.${e}`:null}(t),[a,o]=(0,c.Nk)(n);return[a,(0,r.useCallback)((e=>{n&&o.set(e)}),[n,o])]}({groupId:a}),k=(()=>{const e=l??p;return m({value:e,tabValues:o})?e:null})();(0,r.useLayoutEffect)((()=>{k&&s(k)}),[k]);return{selectedValue:i,selectValue:(0,r.useCallback)((e=>{if(!m({value:e,tabValues:o}))throw new Error(`Can't select invalid tab value=${e}`);s(e),u(e),g(e)}),[u,g,o]),tabValues:o}}var k=n(72389);const b="tabList__CuJ",f="tabItem_LNqP";function y(e){let{className:t,block:n,selectedValue:s,selectValue:l,tabValues:u}=e;const c=[],{blockElementScrollPositionUntilNextRender:p}=(0,i.o5)(),d=e=>{const t=e.currentTarget,n=c.indexOf(t),a=u[n].value;a!==s&&(p(t),l(a))},m=e=>{var t;let n=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{const t=c.indexOf(e.currentTarget)+1;n=c[t]??c[0];break}case"ArrowLeft":{const t=c.indexOf(e.currentTarget)-1;n=c[t]??c[c.length-1];break}}null==(t=n)||t.focus()};return r.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,o.Z)("tabs",{"tabs--block":n},t)},u.map((e=>{let{value:t,label:n,attributes:i}=e;return r.createElement("li",(0,a.Z)({role:"tab",tabIndex:s===t?0:-1,"aria-selected":s===t,key:t,ref:e=>c.push(e),onKeyDown:m,onClick:d},i,{className:(0,o.Z)("tabs__item",f,null==i?void 0:i.className,{"tabs__item--active":s===t})}),n??t)})))}function x(e){let{lazy:t,children:n,selectedValue:a}=e;const o=(Array.isArray(n)?n:[n]).filter(Boolean);if(t){const e=o.find((e=>e.props.value===a));return e?(0,r.cloneElement)(e,{className:"margin-top--md"}):null}return r.createElement("div",{className:"margin-top--md"},o.map(((e,t)=>(0,r.cloneElement)(e,{key:t,hidden:e.props.value!==a}))))}function w(e){const t=g(e);return r.createElement("div",{className:(0,o.Z)("tabs-container",b)},r.createElement(y,(0,a.Z)({},e,t)),r.createElement(x,(0,a.Z)({},e,t)))}function v(e){const t=(0,k.Z)();return r.createElement(w,(0,a.Z)({key:String(t)},e))}},74030:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>l,default:()=>m,frontMatter:()=>s,metadata:()=>u,toc:()=>p});var a=n(87462),r=(n(67294),n(3905)),o=n(74866),i=n(85162);const s={},l="Container Executor",u={unversionedId:"test-types/container-executor",id:"test-types/container-executor",title:"Container Executor",description:"The Testkube Container Executor allows you to run your own container images for executing tests. Testkube orchestrates the Tests using the container image as Kubernetes Jobs.",source:"@site/docs/test-types/container-executor.mdx",sourceDirName:"test-types",slug:"/test-types/container-executor",permalink:"/test-types/container-executor",draft:!1,editUrl:"https://github.com/kubeshop/testkube/docs/docs/test-types/container-executor.mdx",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Prebuilt Testkube Executor",permalink:"/test-types/prebuilt-executor"},next:{title:"Testkube Cloud",permalink:"/testkube-cloud/articles/intro"}},c={},p=[{value:"Creating and Configuring the Container Executor: cURL",id:"creating-and-configuring-the-container-executor-curl",level:2},{value:"Additional settings",id:"additional-settings",level:4},{value:"Creating and Configuring a Container Executor: Playwright",id:"creating-and-configuring-a-container-executor-playwright",level:2},{value:"Input Data",id:"input-data",level:2},{value:"Collecting Test Artifacts",id:"collecting-test-artifacts",level:2}],d={toc:p};function m(e){let{components:t,...s}=e;return(0,r.kt)("wrapper",(0,a.Z)({},d,s,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"container-executor"},"Container Executor"),(0,r.kt)("p",null,"The Testkube Container Executor allows you to run your own container images for executing tests. Testkube orchestrates the Tests using the container image as Kubernetes Jobs."),(0,r.kt)("p",null,"The Test execution fails if the container exits with an error and succeeds when the container command successfully executes."),(0,r.kt)("p",null,"That's the new and recommended way of running custom images. Docs about the prebuilt custom executors can be found ",(0,r.kt)("a",{parentName:"p",href:"/test-types/prebuilt-executor"},"here"),"."),(0,r.kt)("h2",{id:"creating-and-configuring-the-container-executor-curl"},"Creating and Configuring the Container Executor: cURL"),(0,r.kt)("p",null,"In the following example, the custom cURL executor will be creating using ",(0,r.kt)("inlineCode",{parentName:"p"},"curlimages/curl:7.85.0")," image. Testkube supports interacting with custom executors using any of available methods - Testkube Dashboard, CLI, and CRD."),(0,r.kt)(o.Z,{groupId:"dashboard-cli",mdxType:"Tabs"},(0,r.kt)(i.Z,{value:"dash",label:"Dashboard",mdxType:"TabItem"},(0,r.kt)("p",null,"Let's start with Dashboard first. You can view existing executors by going to the Executors tab."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Dashboard menu - executors icon",src:n(12394).Z,width:"170",height:"321"})),(0,r.kt)("p",null,"Also in the Dashboard, you can create a new custom Container Executor. To do this, click the ",(0,r.kt)("inlineCode",{parentName:"p"},"Create a new executor")," button.\nThe executor creation dialog will be displayed. That's where you can name you executor and set the image that will be used for execution. You also need to set ",(0,r.kt)("inlineCode",{parentName:"p"},"Executor type")," - that's the name you will later use in your Tests as the test type. In this example we created a custom Curl executor:"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Container executor creation dialog",src:n(69943).Z,width:"879",height:"439"})),(0,r.kt)("p",null,"After the executor is created, you will be redirected to the executor settings view. That's where you can set additional settings."),(0,r.kt)("h4",{id:"additional-settings"},"Additional settings"),(0,r.kt)("p",null,"In the Command & Arguments tab you can define the Command your custom executor will run and default arguments. Let's set the Command to ",(0,r.kt)("inlineCode",{parentName:"p"},"curl"),":"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Container executor settings - Command and Arguments",src:n(4405).Z,width:"588",height:"621"})),(0,r.kt)("p",null,"The Container Image tab allows you to change the container image which is used, or set ",(0,r.kt)("inlineCode",{parentName:"p"},"Secret ref name")," if the image is in the private registry.\nAdditionally, the Definition tab allows you to check the Executor CRD:"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Container executor settings - Definition",src:n(31208).Z,width:"594",height:"442"})),(0,r.kt)("p",null,"The container executor is created and configured and it can be used for running tests.")),(0,r.kt)(i.Z,{value:"cli",label:"CLI",mdxType:"TabItem"},"The Custom Container Executor can also be created with the Testkube CLI using the `testkube create executor` command:",(0,r.kt)("p",null,"Let's check available the configuration options first:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},'$ testkube create executor --help\nCreate new Executor Custom Resource\n\nUsage:\n  testkube create executor [flags]\n\nAliases:\n  executor, exec, ex\n\nFlags:\n      --args stringArray                 args passed to image in executor\n      --command stringArray              command passed to image in executor\n      --content-type stringArray         list of supported content types for executor\n      --docs-uri string                  URI to executor docs\n      --executor-type string             executor type, container or job (defaults to job) (default "job")\n      --feature stringArray              feature provided by executor\n  -h, --help                             help for executor\n      --icon-uri string                  URI to executor icon\n      --image string                     image used for executor\n      --image-pull-secrets stringArray   secret name used to pull the image in executor\n  -j, --job-template string              if executor needs to be launched using custom job specification, then a path to template file should be provided\n  -l, --label stringToString             label key value pair: --label key1=value1 (default [])\n  -n, --name string                      unique executor name - mandatory\n      --tooltip stringToString           tooltip key value pair: --tooltip key1=value1 (default [])\n  -t, --types stringArray                test types handled by executor\n  -u, --uri string                       if resource need to be loaded from URI\n\nGlobal Flags:\n  -a, --api-uri string     api uri, default value read from config if set (default "http://localhost:8088")\n  -c, --client string      client used for connecting to Testkube API one of proxy|direct (default "proxy")\n      --crd-only           generate only crd\n      --namespace string   Kubernetes namespace, default value read from config if set (default "testkube")\n      --oauth-enabled      enable oauth\n      --verbose            show additional debug messages\n')),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"--name")," is mandatory - that's custom executor's name."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"--executor-type")," need to be set to ",(0,r.kt)("inlineCode",{parentName:"li"},"container")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"--image")," is the executor image (for example, ",(0,r.kt)("inlineCode",{parentName:"li"},"curlimages/curl:7.85.0"),")"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"--types")," that's the name you will later use in your Tests as the test type (for example, ",(0,r.kt)("inlineCode",{parentName:"li"},"executor-curl/test"),")"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"--command")," (for example, ",(0,r.kt)("inlineCode",{parentName:"li"},"curl"),")")),(0,r.kt)("p",null,"Which results in:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"testkube create executor --name curl-container-executor --executor-type container --image curlimages/curl:7.85.0 --types curl-container/test --command curl\n"))),(0,r.kt)(i.Z,{value:"crd",label:"Custom Resource",mdxType:"TabItem"},(0,r.kt)("p",null,"In order to use the Container Executor, create a new executor with ",(0,r.kt)("inlineCode",{parentName:"p"},"executor_type: container")," and your custom type. For example:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},'apiVersion: executor.testkube.io/v1\nkind: Executor\nmetadata:\n  name: curl-container-executor\n  namespace: testkube\nspec:\n  image: curlimages/curl:7.85.0\n  command: ["curl"]\n  executor_type: container\n  imagePullSecrets:\n    - name: secret-name\n  types:\n    - curl-container/test\n')),(0,r.kt)("p",null,"In the above example, all Tests of ",(0,r.kt)("inlineCode",{parentName:"p"},"curl-container/test")," will be executed by this Executor. Then you can create a new test that uses this Executor:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"apiVersion: tests.testkube.io/v3\nkind: Test\nmetadata:\n  name: test-website\n  namespace: testkube\nspec:\n  type: curl-container/test\n  executionRequest:\n    args:\n      - https://testkube.kubeshop.io/\n    variables:\n      TESTKUBE_ENV:\n        name: TESTKUBE_ENV\n        value: example\n")),(0,r.kt)("p",null,"Executing this test will run a Kubernetes Job with:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"curlimages/curl:7.85.0")," image"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"secret-name")," image pull secret"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"curl")," command"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"https://testkube.kubeshop.io/")," argument")),(0,r.kt)("p",null,"You can provide the image, args, command, and image pull secrets in the HTTP Request, Test Spec, and Executor spec. The container executor merges all the data using the following order:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"HTTP Request."),(0,r.kt)("li",{parentName:"ol"},"Test.Spec.ExecutionRequest fields are used if they are not filled before."),(0,r.kt)("li",{parentName:"ol"},"Executor.Spec fields are used if they are not filled before.")))),(0,r.kt)("h2",{id:"creating-and-configuring-a-container-executor-playwright"},"Creating and Configuring a Container Executor: Playwright"),(0,r.kt)("p",null,"Despite having the dedicated ",(0,r.kt)("a",{parentName:"p",href:"/test-types/executor-playwright"},"Playwright executor"),", you may want to use a version that isn't supported. That's where you can use the Container executor. It allows you to use any Playwright image you may need."),(0,r.kt)("p",null,"The example Playwright project uses Playwright ",(0,r.kt)("inlineCode",{parentName:"p"},"1.31.1"),": ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/kubeshop/testkube/tree/main/test/playwright/executor-tests/playwright-project"},"https://github.com/kubeshop/testkube/tree/main/test/playwright/executor-tests/playwright-project"),"\nThat is the specific version that is needed to run the tests. So, in this example the container executor will be created with ",(0,r.kt)("inlineCode",{parentName:"p"},"mcr.microsoft.com/playwright:v1.31.1-focal")," Playwright official image. If you need another image you can find specific image tags in the Playwright Docs: ",(0,r.kt)("a",{parentName:"p",href:"https://playwright.dev/docs/docker#image-tags"},"https://playwright.dev/docs/docker#image-tags"),"."),(0,r.kt)(o.Z,{groupId:"dashboard-cli",mdxType:"Tabs"},(0,r.kt)(i.Z,{value:"dash",label:"Dashboard",mdxType:"TabItem"},(0,r.kt)("p",null,"Again, let's start with the Dashboard first. In order to create a new custom Container Executor you need to go to the Executors tab and then click the ",(0,r.kt)("inlineCode",{parentName:"p"},"Create a new executor")," button."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Dashboard menu - executors icon",src:n(12394).Z,width:"170",height:"321"})),(0,r.kt)("p",null,"The executor creation dialog will be displayed. That's where you can name the executor and set the image that will be used for execution. That's where you also need to set ",(0,r.kt)("inlineCode",{parentName:"p"},"Executor type"),", the name you will later use in your Tests as the test type. In this example we created a custom Playwright executor:"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Container executor creation dialog",src:n(56774).Z,width:"877",height:"440"})),(0,r.kt)("p",null,"After the executor is created, you will be redirected to executor settings view. That's where you can set additional seetings."),(0,r.kt)("p",null,"In this case you will need to set the Command that will be executed."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Container executor settings - command and arguments",src:n(13738).Z,width:"799",height:"686"})),(0,r.kt)("p",null,"Command: ",(0,r.kt)("inlineCode",{parentName:"p"},"/bin/sh -c"),"\nArguments: ",(0,r.kt)("inlineCode",{parentName:"p"},"npm install; npx playwright test"))),(0,r.kt)(i.Z,{value:"cli",label:"CLI",mdxType:"TabItem"},"Custom Container Executor can also be created with Testkube CLI using `testkube create executor` command.",(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"--name")," is mandatory - that's custom executor's name."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"--executor-type")," need to be set to ",(0,r.kt)("inlineCode",{parentName:"li"},"container")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"--image")," is the executor image (",(0,r.kt)("inlineCode",{parentName:"li"},"mcr.microsoft.com/playwright:v1.31.1-focal"),")"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"--types")," that's the name you will later use in your Tests as the test type (for example, ",(0,r.kt)("inlineCode",{parentName:"li"},"executor-playwright/test"),")"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"--command")," (in this case ",(0,r.kt)("inlineCode",{parentName:"li"},"/bin/sh -c"),")"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"--args")," (arguments - in this case ",(0,r.kt)("inlineCode",{parentName:"li"},"npm install; npx playwright test"),")")),(0,r.kt)("p",null,"So, the final command may look like this:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},'testkube create executor --name container-executor-playwright --executor-type container --image mcr.microsoft.com/playwright:v1.31.1-focal --types executor-playwright/test --command "/bin/sh" --command "-c" --args "npm install; npx playwright test"\n'))),(0,r.kt)(i.Z,{value:"crd",label:"Custom Resource",mdxType:"TabItem"},(0,r.kt)("p",null,"Executor CRD:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},'apiVersion: executor.testkube.io/v1\nkind: Executor\nmetadata:\n  name: container-executor-playwright-v1.31.1\n  namespace: testkube\nspec:\n  image: mcr.microsoft.com/playwright:v1.31.1-focal\n  command: ["/bin/sh", "-c"]\n  args:\n  - "npm install; npx playwright test"\n  executor_type: container\n  types:\n  - container-executor-playwright-v1.31.1/test\n')),(0,r.kt)("p",null,"Test CRD:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"apiVersion: tests.testkube.io/v3\nkind: Test\nmetadata:\n  name: container-executor-playwright-smoke\n  namespace: testkube\n  labels:\n    core-tests: executors\nspec:\n  type: container-executor-playwright-v1.31.1/test\n  content:\n    type: git-dir\n    repository:\n      type: git\n      uri: https://github.com/kubeshop/testkube\n      branch: main\n      path: test/playwright/executor-tests/playwright-project\n      workingDir: test/playwright/executor-tests/playwright-project\n")))),(0,r.kt)("h2",{id:"input-data"},"Input Data"),(0,r.kt)("p",null,"You can provide input data via string, files, and Git repositories via the Testkube Dashboard. The data is downloaded into ",(0,r.kt)("inlineCode",{parentName:"p"},"/data")," before the test is run using the Kubernetes Init container. When using the ",(0,r.kt)("inlineCode",{parentName:"p"},"string")," type, the content is put into ",(0,r.kt)("inlineCode",{parentName:"p"},"/data/test-content")," file. For example:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},'apiVersion: tests.testkube.io/v3\nkind: Test\nmetadata:\n  name: custom-container\n  namespace: testkube\nspec:\n  content:\n    data: |-\n      {\n        "project": "testkube",\n        "is": "awesome"\n      }\n    type: string\n  type: custom-container/test\n')),(0,r.kt)("p",null,"Puts data into ",(0,r.kt)("inlineCode",{parentName:"p"},"/data/test-content")," file:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"cat /data/test-content\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json",metastring:'title="Expected output:"',title:'"Expected','output:"':!0},'{\n  "project": "testkube",\n  "is": "awesome"\n}\n')),(0,r.kt)("p",null,"When using Git or Git directory sources, the content is placed inside ",(0,r.kt)("inlineCode",{parentName:"p"},"/data/repo")," directory. For example:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"apiVersion: tests.testkube.io/v3\nkind: Test\nmetadata:\n  name: custom-container\n  namespace: testkube\nspec:\n  content:\n    repository:\n      branch: main\n      type: git\n      uri: https://github.com/kubeshop/testkube-executor-init\n    type: git\n")),(0,r.kt)("p",null,"Downloads into the ",(0,r.kt)("inlineCode",{parentName:"p"},"/data/repo")," directory."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"$ ls /data/repO\nCODE_OF_CONDUCT.md  CONTRIBUTING.md  LICENSE  Makefile  README.md  build  cmd  go.mod  go.sum  pkg\n")),(0,r.kt)("h2",{id:"collecting-test-artifacts"},"Collecting Test Artifacts"),(0,r.kt)("p",null,"For container executors that produce files during test execution, Testkube supports collecting (scraping) these artifacts and storing them in our S3 compatible file storage. You need to save test related files into specified directories on the dynamically created volume. They will be uploaded from there to Testkube file storage and available later for downloading using standard Testkube CLI or Testkube Dashboard commands. For example:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"apiVersion: tests.testkube.io/v3\nkind: Test\nmetadata:\n  name: cli-container\n  namespace: testkube\nspec:\n  type: cli/container\n  executionRequest:\n    artifactRequest:\n      storageClassName: standard\n      volumeMountPath: /share\n      dirs:\n        - test/reports\n")),(0,r.kt)("p",null,"You have to define the storage class name, volume mount path and directories in this volume with test artifacts.\nDefault volume mount path is ",(0,r.kt)("inlineCode",{parentName:"p"},"/data/artifacts")," and directory is ",(0,r.kt)("inlineCode",{parentName:"p"},".")," .\nMake sure your container executor definition has ",(0,r.kt)("inlineCode",{parentName:"p"},"artifacts")," feature. For example:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"apiVersion: executor.testkube.io/v1\nkind: Executor\nmetadata:\n  name: cli-container-executor\n  namespace: testkube\nspec:\n  types:\n    - cli/container\n  executor_type: container\n  image: soleware/nx-cli:8.5.2\n  command:\n    - /bin/bash\n    - -c\n    - pwd; echo 'Change dir to /share'; cd /share; echo 'create test/reports'; mkdir -p test/reports; echo 'test data' > test/reports/result.txt\n  features:\n    - artifacts\n")),(0,r.kt)("p",null,"Run your test using the CLI command:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"testkube run test cli-container\n")),(0,r.kt)("p",null,"Then get available artifacts for your test execution id:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"testkube get artifact 638a08b94ff1d2c694aeebf2\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh",metastring:'title="Expected output:"',title:'"Expected','output:"':!0},"  NAME       | SIZE (KB)\n-------------+------------\n  result.txt |        10\n")))}m.isMDXComponent=!0},69943:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/dashboard-create-an-executor-dialog-curl-572ae8dd0ca4793f9382d7288d34c1de.png"},56774:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/dashboard-create-an-executor-dialog-playwright-1a48b81faa9f4717b42d24f1ca7422dc.png"},13738:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/dashboard-create-executor-playwright-command-args-3c81ee6b36585a7f258cca036ff2e98b.png"},4405:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/dashboard-executor-settings-command-arguments-f62a3c13af482468f35f507b9b0c3bbf.png"},31208:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/dashboard-executor-settings-definition-37edc37882193ded4a78622e0777022d.png"},12394:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/dashboard-executors-icon-481f86fe948f2abb60b26f712affb302.png"}}]);