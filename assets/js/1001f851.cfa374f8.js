"use strict";(self.webpackChunktestkube_documentation=self.webpackChunktestkube_documentation||[]).push([[650],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>d});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},s=Object.keys(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var u=a.createContext({}),l=function(e){var t=a.useContext(u),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},c=function(e){var t=l(e.components);return a.createElement(u.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},h=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,s=e.originalType,u=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),h=l(n),d=r,b=h["".concat(u,".").concat(d)]||h[d]||p[d]||s;return n?a.createElement(b,o(o({ref:t},c),{},{components:n})):a.createElement(b,o({ref:t},c))}));function d(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var s=n.length,o=new Array(s);o[0]=h;var i={};for(var u in t)hasOwnProperty.call(t,u)&&(i[u]=t[u]);i.originalType=e,i.mdxType="string"==typeof e?e:r,o[1]=i;for(var l=2;l<s;l++)o[l]=n[l];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}h.displayName="MDXCreateElement"},95083:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>u,contentTitle:()=>o,default:()=>p,frontMatter:()=>s,metadata:()=>i,toc:()=>l});var a=n(87462),r=(n(67294),n(3905));const s={sidebar_position:1,sidebar_label:"OAuth for UI"},o="Testkube UI Authentication",i={unversionedId:"authentication/oauth-ui",id:"authentication/oauth-ui",title:"Testkube UI Authentication",description:"Testkube doesn't provide a separate user/role management system to protect access to its UI.",source:"@site/docs/8-authentication/oauth-ui.md",sourceDirName:"8-authentication",slug:"/authentication/oauth-ui",permalink:"/testkube/authentication/oauth-ui",draft:!1,editUrl:"https://github.com/kubeshop/testkube/docs/docs/8-authentication/oauth-ui.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1,sidebar_label:"OAuth for UI"},sidebar:"tutorialSidebar",previous:{title:"Authentication",permalink:"/testkube/category/authentication"},next:{title:"OAuth for CLI",permalink:"/testkube/authentication/oauth-cli"}},u={},l=[{value:"<strong>Provide Parameters for UI and API Ingresses</strong>",id:"provide-parameters-for-ui-and-api-ingresses",level:2},{value:"<strong>API Ingress</strong>",id:"api-ingress",level:3},{value:"<strong>UI Ingress</strong>",id:"ui-ingress",level:3},{value:"<strong>Create Cookie Secret</strong>",id:"create-cookie-secret",level:2},{value:"<strong>Create Github OAuth Application</strong>",id:"create-github-oauth-application",level:2},{value:"<strong>OAuth Service, Deployment and Ingresses Parameters</strong>",id:"oauth-service-deployment-and-ingresses-parameters",level:2}],c={toc:l};function p(e){let{components:t,...s}=e;return(0,r.kt)("wrapper",(0,a.Z)({},c,s,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"testkube-ui-authentication"},"Testkube UI Authentication"),(0,r.kt)("p",null,"Testkube doesn't provide a separate user/role management system to protect access to its UI.\nUsers can configure and OAuth based authentication module using Testkube Helm chart parameters.\nTestkube can automatically create an OAuth2-Proxy service and deployment integrated\nwith GitHub, as well as properly configure Kubernetes Nginx Ingress Controller and create required\ningresses."),(0,r.kt)("h2",{id:"provide-parameters-for-ui-and-api-ingresses"},(0,r.kt)("strong",{parentName:"h2"},"Provide Parameters for UI and API Ingresses")),(0,r.kt)("h3",{id:"api-ingress"},(0,r.kt)("strong",{parentName:"h3"},"API Ingress")),(0,r.kt)("p",null,"Pass values to Testkube Helm chart during installation or upgrade (they are empty by default).\nPay attention to the usage of the scheme (http or https) in URIs."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'--set testkube-api.uiIngress.enabled=true \\\n--set testkube-api.uiIngress.annotations."nginx\\.ingress\\.kubernetes\\.io/auth-url"="http://\\$host/oauth2/auth" \\\n--set testkube-api.uiIngress.annotations."nginx\\.ingress\\.kubernetes\\.io/auth-signin"="http://\\$host/oauth2/start?rd=\\$escaped_request_uri" \\\n--set testkube-api.uiIngress.annotations."nginx\\.ingress\\.kubernetes\\.io/access-control-allow-origin"="*"\n')),(0,r.kt)("h3",{id:"ui-ingress"},(0,r.kt)("strong",{parentName:"h3"},"UI Ingress")),(0,r.kt)("p",null,"Pass values to Testkube Helm chart during installation or upgrade (they are empty by default).\nPay attention to the usage of the scheme (http or https) in URIs."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'--set testkube-dashboard.ingress.enabled=true \\\n--set testkube-dashboard.ingress.annotations."nginx\\.ingress\\.kubernetes\\.io/auth-url"="http://\\$host/oauth2/auth" \\\n--set testkube-dashboard.ingress.annotations."nginx\\.ingress\\.kubernetes\\.io/auth-signin"="http://\\$host/oauth2/start?rd=\\$escaped_request_uri"\n')),(0,r.kt)("h2",{id:"create-cookie-secret"},(0,r.kt)("strong",{parentName:"h2"},"Create Cookie Secret")),(0,r.kt)("p",null,"Use OpenSSL to generate a shared secret or it can be any 16 or 32 byte value 64base encoded."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"$ openssl rand -hex 16\n48f0a2b815ddc0a437825ccb27548d25\n")),(0,r.kt)("h2",{id:"create-github-oauth-application"},(0,r.kt)("strong",{parentName:"h2"},"Create Github OAuth Application")),(0,r.kt)("p",null,"Register a new Github OAuth application for your personal or organizational account."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Register new App",src:n(62947).Z,width:"1418",height:"977"})),(0,r.kt)("p",null,"Pay attention to the usage of the scheme (http or https) in URIs.\nThe homepage URL\nshould be the UI home page ",(0,r.kt)("a",{parentName:"p",href:"http://testdash.testkube.io"},"http://testdash.testkube.io"),"."),(0,r.kt)("p",null,"The authorization callback URL\nshould be a prebuilt page at the UI website ",(0,r.kt)("a",{parentName:"p",href:"http://testdash.testkube.io/oauth2/callback"},"http://testdash.testkube.io/oauth2/callback"),"."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"View created App",src:n(25737).Z,width:"1282",height:"953"})),(0,r.kt)("p",null,"Remember the generated Client ID and Client Secret."),(0,r.kt)("h2",{id:"oauth-service-deployment-and-ingresses-parameters"},(0,r.kt)("strong",{parentName:"h2"},"OAuth Service, Deployment and Ingresses Parameters")),(0,r.kt)("p",null,"Pass values to the Testkube Helm chart during installation or upgrade (they are empty by default).\nPay attention to the usage of the scheme (http or https) in URIs."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'--set testkube-dashboard.oauth2.enabled=true \\\n--set testkube-dashboard.oauth2.env.clientId="Client ID from Github OAuth application" \\\n--set testkube-dashboard.oauth2.env.clientSecret="Client Secret from Github OAuth application" \\\n--set testkube-dashboard.oauth2.env.githubOrg="Github organization - if you need to provide access only to members of your organization" \\\n--set testkube-dashboard.oauth2.env.cookieSecret="cookie secret generated above" \\\n--set testkube-dashboard.oauth2.env.cookieSecure="false - for http connection, true - for https connections" \\\n--set testkube-dashboard.oauth2.env.redirectUrl="http://demo.testkube.io/oauth2/callback"\n')))}p.isMDXComponent=!0},62947:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/github_app_request_ui-fa2f97ce9920ed96764a055bfa13ff08.png"},25737:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/github_app_response_ui-c0de2a245493ab0edbd199abb55a9b09.png"}}]);