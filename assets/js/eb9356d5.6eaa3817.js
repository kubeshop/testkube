"use strict";(self.webpackChunktestkube_documentation=self.webpackChunktestkube_documentation||[]).push([[3605],{3905:(e,t,a)=>{a.d(t,{Zo:()=>h,kt:()=>d});var r=a(67294);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function s(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?s(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},s=Object.keys(e);for(r=0;r<s.length;r++)a=s[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)a=s[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var u=r.createContext({}),l=function(e){var t=r.useContext(u),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},h=function(e){var t=l(e.components);return r.createElement(u.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},p=r.forwardRef((function(e,t){var a=e.components,n=e.mdxType,s=e.originalType,u=e.parentName,h=i(e,["components","mdxType","originalType","parentName"]),p=l(a),d=n,b=p["".concat(u,".").concat(d)]||p[d]||c[d]||s;return a?r.createElement(b,o(o({ref:t},h),{},{components:a})):r.createElement(b,o({ref:t},h))}));function d(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var s=a.length,o=new Array(s);o[0]=p;var i={};for(var u in t)hasOwnProperty.call(t,u)&&(i[u]=t[u]);i.originalType=e,i.mdxType="string"==typeof e?e:n,o[1]=i;for(var l=2;l<s;l++)o[l]=a[l];return r.createElement.apply(null,o)}return r.createElement.apply(null,a)}p.displayName="MDXCreateElement"},46400:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>u,contentTitle:()=>o,default:()=>c,frontMatter:()=>s,metadata:()=>i,toc:()=>l});var r=a(87462),n=(a(67294),a(3905));const s={},o="OAuth for Testkube Dashboard",i={unversionedId:"guides/authentication/oauth-ui",id:"guides/authentication/oauth-ui",title:"OAuth for Testkube Dashboard",description:"Testkube doesn't provide a separate user/role management system to protect access to its Dashboard.",source:"@site/docs/guides/authentication/oauth-ui.md",sourceDirName:"guides/authentication",slug:"/guides/authentication/oauth-ui",permalink:"/testkube/guides/authentication/oauth-ui",draft:!1,editUrl:"https://github.com/kubeshop/testkube/docs/docs/guides/authentication/oauth-ui.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"OAuth for CLI",permalink:"/testkube/guides/authentication/oauth-cli"},next:{title:"Implementing Webhooks",permalink:"/testkube/guides/webhooks"}},u={},l=[{value:"Provide Parameters for Dashboard and API Ingresses",id:"provide-parameters-for-dashboard-and-api-ingresses",level:2},{value:"API Ingress",id:"api-ingress",level:3},{value:"Testkube Dashboard Ingress",id:"testkube-dashboard-ingress",level:3},{value:"Create Cookie Secret",id:"create-cookie-secret",level:2},{value:"Create Github OAuth Application",id:"create-github-oauth-application",level:2},{value:"OAuth Service, Deployment and Ingresses Parameters",id:"oauth-service-deployment-and-ingresses-parameters",level:2}],h={toc:l};function c(e){let{components:t,...s}=e;return(0,n.kt)("wrapper",(0,r.Z)({},h,s,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"oauth-for-testkube-dashboard"},"OAuth for Testkube Dashboard"),(0,n.kt)("p",null,"Testkube doesn't provide a separate user/role management system to protect access to its Dashboard."),(0,n.kt)("p",null,"Users can configure and OAuth based authentication module using Testkube Helm chart parameters."),(0,n.kt)("p",null,"Testkube can automatically create an OAuth2-Proxy service and deployment integrated\nwith GitHub, as well as properly configure Kubernetes NGINX Ingress Controller and create required ingresses."),(0,n.kt)("h2",{id:"provide-parameters-for-dashboard-and-api-ingresses"},"Provide Parameters for Dashboard and API Ingresses"),(0,n.kt)("h3",{id:"api-ingress"},"API Ingress"),(0,n.kt)("p",null,"Pass values to Testkube Helm chart during installation or upgrade (they are empty by default).\nPay attention to the usage of the scheme (http or https) in URIs."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},'--set testkube-api.uiIngress.enabled=true \\\n--set testkube-api.uiIngress.annotations."nginx\\.ingress\\.kubernetes\\.io/auth-url"="http://\\$host/oauth2/auth" \\\n--set testkube-api.uiIngress.annotations."nginx\\.ingress\\.kubernetes\\.io/auth-signin"="http://\\$host/oauth2/start?rd=\\$escaped_request_uri" \\\n--set testkube-api.uiIngress.annotations."nginx\\.ingress\\.kubernetes\\.io/access-control-allow-origin"="*"\n')),(0,n.kt)("h3",{id:"testkube-dashboard-ingress"},"Testkube Dashboard Ingress"),(0,n.kt)("p",null,"Pass values to Testkube Helm chart during installation or upgrade (they are empty by default).\nPay attention to the usage of the scheme (http or https) in URIs."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},'--set testkube-dashboard.ingress.enabled=true \\\n--set testkube-dashboard.ingress.annotations."nginx\\.ingress\\.kubernetes\\.io/auth-url"="http://\\$host/oauth2/auth" \\\n--set testkube-dashboard.ingress.annotations."nginx\\.ingress\\.kubernetes\\.io/auth-signin"="http://\\$host/oauth2/start?rd=\\$escaped_request_uri"\n')),(0,n.kt)("h2",{id:"create-cookie-secret"},"Create Cookie Secret"),(0,n.kt)("p",null,"Use OpenSSL to generate a shared secret or it can be any 16 or 32 byte value 64base encoded."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},"$ openssl rand -hex 16\n48f0a2b815ddc0a437825ccb27548d25\n")),(0,n.kt)("h2",{id:"create-github-oauth-application"},"Create Github OAuth Application"),(0,n.kt)("p",null,"Register a new Github OAuth application for your personal or organizational account."),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Register new App",src:a(62947).Z,width:"1418",height:"977"})),(0,n.kt)("p",null,"Pay attention to the usage of the scheme (http or https) in URIs."),(0,n.kt)("p",null,"The homepage URL should be the Testkube Dashboard home page ",(0,n.kt)("a",{parentName:"p",href:"http://testdash.testkube.io"},"http://testdash.testkube.io"),"."),(0,n.kt)("p",null,"The authorization callback URL should be a prebuilt page at the Testkube Dashboard ",(0,n.kt)("a",{parentName:"p",href:"http://testdash.testkube.io/oauth2/callback"},"http://testdash.testkube.io/oauth2/callback"),"."),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"View created App",src:a(25737).Z,width:"1282",height:"953"})),(0,n.kt)("p",null,"Remember the generated Client ID and Client Secret."),(0,n.kt)("h2",{id:"oauth-service-deployment-and-ingresses-parameters"},"OAuth Service, Deployment and Ingresses Parameters"),(0,n.kt)("p",null,"Pass values to the Testkube Helm chart during installation or upgrade (they are empty by default).\nPay attention to the usage of the scheme (http or https) in URIs."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},'--set testkube-dashboard.oauth2.enabled=true \\\n--set testkube-dashboard.oauth2.env.clientId="Client ID from Github OAuth application" \\\n--set testkube-dashboard.oauth2.env.clientSecret="Client Secret from Github OAuth application" \\\n--set testkube-dashboard.oauth2.env.githubOrg="Github organization - if you need to provide access only to members of your organization" \\\n--set testkube-dashboard.oauth2.env.cookieSecret="cookie secret generated above" \\\n--set testkube-dashboard.oauth2.env.cookieSecure="false - for http connection, true - for https connections" \\\n--set testkube-dashboard.oauth2.env.redirectUrl="http://demo.testkube.io/oauth2/callback"\n')))}c.isMDXComponent=!0},62947:(e,t,a)=>{a.d(t,{Z:()=>r});const r=a.p+"assets/images/github_app_request_ui-fa2f97ce9920ed96764a055bfa13ff08.png"},25737:(e,t,a)=>{a.d(t,{Z:()=>r});const r=a.p+"assets/images/github_app_response_ui-c0de2a245493ab0edbd199abb55a9b09.png"}}]);